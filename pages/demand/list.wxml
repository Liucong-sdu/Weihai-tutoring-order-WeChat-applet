<!--pages/demand/list.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="title">æˆ‘çš„éœ€æ±‚</text>
  </view>

  <!-- éœ€æ±‚åˆ—è¡¨ -->
  <view class="demand-list" wx:if="{{demands.length > 0}}">
    <view
      class="demand-item"
      wx:for="{{demands}}"
      wx:key="id"
      data-id="{{item.id}}"
      bindtap="viewDemandDetail"
    >
      <!-- éœ€æ±‚åŸºæœ¬ä¿¡æ¯ -->
      <view class="demand-header">
        <view class="demand-info">
          <text class="grade">{{item.grade.name}}</text>
          <text class="subject">{{item.subject.name}}</text>
          <text class="price">Â¥{{item.hourlyPrice}}/å°æ—¶</text>
        </view>
        <view class="demand-status {{getStatusClass(item.status)}}">
          {{getStatusText(item.status)}}
        </view>
      </view>

      <!-- éœ€æ±‚è¯¦ç»†ä¿¡æ¯ -->
      <view class="demand-detail">
        <view class="detail-item">
          <text class="icon">ğŸ“</text>
          <text class="text">{{item.locationAddress}}</text>
        </view>
        <view class="detail-item">
          <text class="icon">â°</text>
          <text class="text">{{formatTime(item.createdAt)}}</text>
        </view>
      </view>

      <!-- æ“ä½œæç¤º -->
      <view class="demand-hint">
        <text wx:if="{{item.status === 'PENDING'}}">æ­£åœ¨ç­‰å¾…ç®¡ç†å‘˜å¤„ç†</text>
        <text wx:if="{{item.status === 'FOLLOWING_UP'}}">ç®¡ç†å‘˜æ­£åœ¨è·Ÿè¿›æ‚¨çš„éœ€æ±‚</text>
        <text wx:if="{{item.status === 'MATCHED'}}">å·²ä¸ºæ‚¨åŒ¹é…åˆé€‚çš„å®¶æ•™è€å¸ˆ</text>
        <text wx:if="{{item.status === 'CLOSED'}}">éœ€æ±‚å·²å…³é—­</text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && demands.length === 0}}">
    <view class="empty-icon">ğŸ“‹</view>
    <text class="empty-title">æš‚æ— éœ€æ±‚è®°å½•</text>
    <text class="empty-desc">æ‚¨è¿˜æ²¡æœ‰æäº¤è¿‡ä»»ä½•å®¶æ•™éœ€æ±‚</text>
    <button class="empty-btn" bindtap="goToSubmit">å»å‘å¸ƒéœ€æ±‚</button>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-content">
      <text>æ­£åœ¨åŠ è½½...</text>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{hasMore && !loading}}">
    <view class="load-more-text" wx:if="{{!loadingMore}}">ä¸Šæ‹‰åŠ è½½æ›´å¤š</view>
    <view class="load-more-text" wx:if="{{loadingMore}}">åŠ è½½ä¸­...</view>
  </view>

  <!-- æ²¡æœ‰æ›´å¤šäº† -->
  <view class="no-more" wx:if="{{!hasMore && demands.length > 0 && !loading}}">
    <text>æ²¡æœ‰æ›´å¤šäº†</text>
  </view>
</view>